<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Dashboard</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
            background-color: #f4f4f4;
        }

        h1 {
            color: #333;
        }

        .form-group {
            margin-bottom: 15px;
        }

        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }

        .form-group input, .form-group button {
            padding: 10px;
            font-size: 16px;
        }

        .ban-list {
            margin-top: 20px;
        }

        .ban-list h3 {
            margin-bottom: 10px;
        }

        .ban-list ul {
            list-style: none;
            padding: 0;
        }

        .ban-list li {
            display: flex;
            justify-content: space-between;
            padding: 5px;
            background-color: #fff;
            border: 1px solid #ddd;
            margin-bottom: 5px;
        }

        .ban-list button {
            padding: 5px;
            font-size: 14px;
            cursor: pointer;
        }
    </style>
</head>
<body>
    <h1>Admin Dashboard</h1>

    <div class="form-group">
        <label for="canvas-size">Set Canvas Size (e.g., 50x50):</label>
        <input type="text" id="canvas-size" placeholder="Width x Height">
        <button id="set-size">Set Size</button>
    </div>

    <div class="form-group">
        <button id="clear-all">Clear All Pixels</button>
    </div>

    <div class="form-group">
        <label for="ban-user">Ban User by ID:</label>
        <input type="text" id="ban-user" placeholder="Enter User ID">
        <button id="ban-button">Ban User</button>
    </div>

    <div class="ban-list">
        <h3>Banned Users:</h3>
        <ul id="banned-users-list"></ul>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getDatabase, ref, set, remove, onValue } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-database.js";

        const firebaseConfig = {
            apiKey: "AIzaSyCpOUr78CAyGatrQdVOw6yf8EK4OvtoMoo",
            authDomain: "astro-places-1aec2.firebaseapp.com",
            projectId: "astro-places-1aec2",
            storageBucket: "astro-places-1aec2.firebasestorage.app",
            messagingSenderId: "502500788903",
            appId: "1:502500788903:web:5f742fd1ad5cce9063e982",
            measurementId: "G-6J7SM1KM05"
        };

        const app = initializeApp(firebaseConfig);
        const database = getDatabase(app);

        const canvasSizeInput = document.getElementById('canvas-size');
        const setSizeButton = document.getElementById('set-size');
        const clearAllButton = document.getElementById('clear-all');
        const banUserInput = document.getElementById('ban-user');
        const banButton = document.getElementById('ban-button');
        const bannedUsersList = document.getElementById('banned-users-list');

        // Set canvas size
        setSizeButton.addEventListener('click', () => {
            const size = canvasSizeInput.value.split('x').map(Number);
            if (size.length === 2 && size[0] > 0 && size[1] > 0) {
                set(ref(database, 'canvas/size'), { width: size[0], height: size[1] });
                alert(`Canvas size set to ${size[0]}x${size[1]}`);
            } else {
                alert('Invalid size format. Use Width x Height.');
            }
        });

        // Clear all pixels
        clearAllButton.addEventListener('click', () => {
            set(ref(database, 'pixels'), null);
            alert('All pixels cleared.');
        });

        // Ban user
        banButton.addEventListener('click', () => {
            const userId = banUserInput.value.trim();
            if (userId) {
                set(ref(database, `banned/${userId}`), true);
                banUserInput.value = '';
                alert(`User ${userId} has been banned.`);
            } else {
                alert('Please enter a valid User ID.');
            }
        });

        // Load and display banned users
        const bannedUsersRef = ref(database, 'banned');
        onValue(bannedUsersRef, (snapshot) => {
            bannedUsersList.innerHTML = '';
            const data = snapshot.val();
            if (data) {
                Object.keys(data).forEach((userId) => {
                    const listItem = document.createElement('li');
                    listItem.textContent = userId;
                    const unbanButton = document.createElement('button');
                    unbanButton.textContent = 'Unban';
                    unbanButton.addEventListener('click', () => {
                        remove(ref(database, `banned/${userId}`));
                        alert(`User ${userId} has been unbanned.`);
                    });
                    listItem.appendChild(unbanButton);
                    bannedUsersList.appendChild(listItem);
                });
            }
        });
    </script>
</body>
</html>
